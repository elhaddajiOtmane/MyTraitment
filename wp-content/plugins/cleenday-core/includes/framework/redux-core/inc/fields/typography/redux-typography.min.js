!function(e){"use strict";var t=[],a=!1,r=!0;redux.field_objects=redux.field_objects||{},redux.field_objects.typography=redux.field_objects.typography||{},redux.field_objects.typography.init=function(s){s=e.redux.getSelector(s,"typography"),e(s).each(function(){var s=e(this),i=s;s.hasClass("redux-field-container")||(i=s.parents(".redux-field-container:first")),i.is(":hidden")||(void 0===redux.field_objects.pro&&(r=!1),s.each(function(){e(this).find(".redux-typography-container").each(function(){var s,i,o,p,d,l,n=e(this),y=n,h=e(this).find(".redux-typography-family"),u=h.data("value"),g=e(this).find(".redux-typography-family").parents(".redux-container-typography:first").data("id"),f=e("#"+g+" .redux-typography-google").val(),c=[],x=[],v=e("#"+g+" .redux-typography-font-family").data("user-fonts");if(n.hasClass("redux-field-container")||(y=n.parents(".redux-field-container:first")),!y.is(":hidden")&&y.hasClass("redux-field-init")){if(y.removeClass("redux-field-init"),void 0===u?h=e(this):""!==u&&e(h).val(u),v=v?1:0,f=f?1:0,void 0!==redux.customfonts&&c.push(redux.customfonts),void 0!==redux.typekitfonts&&c.push(redux.typekitfonts),void 0!==redux.stdfonts&&0===v&&c.push(redux.stdfonts),1===v){for(s in redux.optName.typography[g])if(redux.optName.typography[g].hasOwnProperty(s))for(o in i=redux.optName.typography[g].std_font)i.hasOwnProperty(o)&&x.push({id:o,text:o,"data-google":"false"});p={text:"Standard Fonts",children:x},c.push(p)}(1===f||!0===f&&void 0!==redux.googlefonts)&&c.push(redux.googlefonts),l=c,d=e(this).find(".redux-typography-family").data("value"),e(this).find(".redux-typography-family").addClass("ignore-change"),e(this).find(".redux-typography-family").select2({data:l}),e(this).find(".redux-typography-family").val(d).trigger("change"),e(this).find(".redux-typography-family").removeClass("ignore-change"),n.find(".redux-typography-family").hasClass("redux-typography-family")||n.find(".redux-typography-style").select2(),e(this).find(".redux-typography-align").select2(),e(this).find(".redux-typography-family-backup").select2(),e(this).find(".redux-typography-transform").select2(),e(this).find(".redux-typography-font-variant").select2(),e(this).find(".redux-typography-decoration").select2(),e(this).find(".redux-insights-data-we-collect-typography").on("click",function(t){t.preventDefault(),e(this).parent().find(".description").toggle()}),redux.field_objects.typography.select(h,!0,!1,null,!0),e(this).find(".redux-typography-family, .redux-typography-family-backup, .redux-typography-style, .redux-typography-subsets, .redux-typography-align").on("change",function(r){var s,i,o=e(this).attr("id"),p=e("#"+o);e(this).hasClass("redux-typography-family")?p.val()&&(i=(s=e(this).select2("data"))?s[0].text:null,p.data("value",i),t=s[0],a=!0,redux.field_objects.typography.select(p,!0,!1,i,!0)):(r=p.val(),p.data("value",r),(e(this).hasClass("redux-typography-align")||e(this).hasClass("redux-typography-subsets")||e(this).hasClass("redux-typography-family-backup")||e(this).hasClass("redux-typography-transform")||e(this).hasClass("redux-typography-font-variant")||e(this).hasClass("redux-typography-decoration"))&&(p.find('option[selected="selected"]').removeAttr("selected"),p.find('option[value="'+r+'"]').attr("selected","selected")),e(this).hasClass("redux-typography-subsets")&&p.siblings(".typography-subsets").val(r),redux.field_objects.typography.select(e(this),!0,!1,null,!1))}),e(this).find(".redux-typography-size, .redux-typography-height, .redux-typography-word, .redux-typography-letter").keyup(function(){redux.field_objects.typography.select(e(this).parents(".redux-container-typography:first"))}),r&&(redux.field_objects.pro.typography.fieldChange(e(this)),redux.field_objects.pro.typography.colorPicker(e(this))),e(this).find(".redux-typography-color").wpColorPicker({change:function(t,a){e(this).val(a.color.toString()),redux.field_objects.typography.select(e(this).parents(".redux-container-typography:first"))}}),e(this).find(".redux-typography-size").numeric({allowMinus:!1}),e(this).find(".redux-typography-height, .redux-typography-word, .redux-typography-letter").numeric({allowMinus:!0}),e(this).find(".redux-typography").on("select2:unselecting",function(){var t,a,r=e(this).data("select2").options;r.set("disabled",!0),setTimeout(function(){r.set("disabled",!1)},1),t=e(this).attr("id"),(a=e("#"+t)).data("value",""),e(this).hasClass("redux-typography-family")?(e(this).find(".redux-typography-family").addClass("ignore-change"),e(this).val(null).trigger("change"),e(this).find(".redux-typography-family").removeClass("ignore-change"),redux.field_objects.typography.select(a,!0,!1,null,!0)):((e(this).hasClass("redux-typography-align")||e(this).hasClass("redux-typography-subsets")||e(this).hasClass("redux-typography-family-backup")||e(this).hasClass("redux-typography-transform")||e(this).hasClass("redux-typography-font-variant")||e(this).hasClass("redux-typography-decoration"))&&e("#"+t+' option[selected="selected"]').removeAttr("selected"),e(this).hasClass("redux-typography-subsets")&&a.siblings(".typography-subsets").val(""),e(this).hasClass("redux-typography-family-backup")&&(e(this).find(".redux-typography-family-backup").addClass("ignore-change"),a.val(null).trigger("change"),e(this).find(".redux-typography-family-backup").removeClass("ignore-change")),redux.field_objects.typography.select(e(this),!0,!1,null,!1))}),redux.field_objects.typography.updates(e(this)),window.onbeforeunload=null,y.removeClass("redux-field-init")}})}))})},redux.field_objects.typography.updates=function(t){t.find(".update-google-fonts").bind("click",function(a){var r=e(this).data("action"),s=e(this).parent().parent(),i=s.attr("data-nonce");return s.find("p").text(redux_typography_ajax.update_google_fonts.updating),s.find("p").attr("aria-label",redux_typography_ajax.update_google_fonts.updating),s.removeClass("updating-message updated-message notice-success notice-warning notice-error").addClass("update-message notice-warning updating-message"),e.ajax({type:"post",dataType:"json",url:redux_typography_ajax.ajaxurl,data:{action:"redux_update_google_fonts",nonce:i,data:r},error:function(e){var a;console.log(e),s.removeClass("notice-warning updating-message updated-message notice-success").addClass("notice-error"),(a=e.error)&&(a=': "'+a+'"'),s.find("p").html(redux_typography_ajax.update_google_fonts.error.replace("%s",r).replace("|msg",a)),s.find("p").attr("aria-label",redux_typography_ajax.update_google_fonts.error),redux.field_objects.typography.updates(t)},success:function(a){var i;console.log(a),"success"===a.status?(s.find("p").html(redux_typography_ajax.update_google_fonts.success),s.find("p").attr("aria-label",redux_typography_ajax.update_google_fonts.success),s.removeClass("updating-message notice-warning").addClass("updated-message notice-success"),e(".redux-update-google-fonts").not(".notice-success").remove()):(s.removeClass("notice-warning updating-message updated-message notice-success").addClass("notice-error"),(i=a.error)&&(i=': "'+i+'"'),s.find("p").html(redux_typography_ajax.update_google_fonts.error.replace("%s",r).replace("|msg",i)),s.find("p").attr("aria-label",redux_typography_ajax.update_google_fonts.error),redux.field_objects.typography.updates(t))}}),a.preventDefault(),!1})},redux.field_objects.typography.size=function(e){var t,a=0;for(t in e)e.hasOwnProperty(t)&&(a+=1);return a},redux.field_objects.typography.makeBool=function(e){return"false"!==e&&"0"!==e&&!1!==e&&0!==e&&("true"===e||"1"===e||!0===e||1===e||void 0)},redux.field_objects.typography.contrastColour=function(e){var t="#444444";return""!==e&&(e=e.replace("#",""),t=(299*parseInt(e.substr(0,2),16)+587*parseInt(e.substr(2,2),16)+114*parseInt(e.substr(4,2),16))/1e3>=128?"#444444":"#ffffff"),t},redux.field_objects.typography.select=function(s,i,o,p,d){var l,n,y,h,u,g,f,c,x,v,m,b,_,C,j,w,k,z,O,I,S=!1,B="",N='<option value=""></option>',P="",F={400:"Normal 400",700:"Bold 700","400italic":"Normal 400 Italic","700italic":"Bold 700 Italic"};void 0===(l=e(s).parents(".redux-container-typography:first").data("id"))&&(l=e(s).data("id")),n=e("#"+l),(y=e("#"+l+"-family").val())||(y=null),p&&(y=p),u=n.find("select.redux-typography-family-backup").val(),g=n.find(".redux-typography-size").val(),f=n.find(".redux-typography-height").val(),c=n.find(".redux-typography-word").val(),x=n.find(".redux-typography-letter").val(),v=n.find("select.redux-typography-align").val(),m=n.find("select.redux-typography-transform").val(),b=n.find("select.redux-typography-font-variant").val(),_=n.find("select.redux-typography-decoration").val(),C=n.find("select.redux-typography-style").val(),j=n.find("select.redux-typography-subsets").val(),w=n.find(".redux-typography-color").val(),k=n.data("units"),I=e("#"+l+" select.redux-typography-style-multi").val();var D="";if(!0===a?(h=redux.field_objects.typography.makeBool(t["data-google"]),n.find(".redux-typography-google-font").val(h)):h=redux.field_objects.typography.makeBool(n.find(".redux-typography-google-font").val()),d)if(n.hasClass("typography-initialized")||(I=e("#"+l+" select.redux-typography-style-multi").data("value"),C=n.find("select.redux-typography-style").data("value"),j=n.find("select.redux-typography-subsets").data("value"),""!==C&&(C=String(C)),""!==I&&(I=String(I)),D=I.split(","),void 0!==typeof j&&(j=String(j))),void 0===redux.fonts.google&&(h=!1),!0===h&&y in redux.fonts.google?B=redux.fonts.google[y]:void 0!==redux.fonts.typekit&&y in redux.fonts.typekit?(S=!0,B=redux.fonts.typekit[y]):B=F,e(s).hasClass("redux-typography-subsets")&&n.find("input.typography-subsets").val(j),e(s).hasClass("redux-typography-family")){if(!0===h){P="";var W="";e.each(B.variants,function(e,t){t.id===C||1===redux.field_objects.typography.size(B.variants)?(P=' selected="selected"',C=t.id):P="",N+='<option value="'+t.id+'"'+P+">"+t.name.replace(/\+/g," ")+"</option>";for(var a=0;a<D.length;++a){if(t.id===D[a]){W=' selected="selected"';break}W=""}'<option value="'+t.id+'"'+W+">"+t.name.replace(/\+/g," ")+"</option>"}),o&&(n.find(".redux-typography-style").select2("destroy"),n.find(".redux-typography-style-multi").select2("destroy")),n.find(".redux-typography-style").html(N).select2(),n.find(".redux-typography-style-multi").html(N).select2(),P="",N='<option value=""></option>',e.each(B.subsets,function(e,t){j===t.id||1===redux.field_objects.typography.size(B.subsets)?(P=' selected="selected"',j=t.id,n.find("input.typography-subsets").val(j)):P="",N+='<option value="'+t.id+'"'+P+">"+t.name.replace(/\+/g," ")+"</option>"}),o&&n.find(".redux-typography-subsets").select2("destroy"),n.find(".redux-typography-subsets").html(N).select2({width:"100%"}),n.find(".redux-typography-subsets").parent().fadeIn("fast"),n.find(".typography-family-backup").fadeIn("fast")}else!0===S?(e.each(B.variants,function(e,t){C===t.id||1===redux.field_objects.typography.size(B.variants)?(P=' selected="selected"',C=t.id):P="",N+='<option value="'+t.id+'"'+P+">"+t.name.replace(/\+/g," ")+"</option>";for(var a=0;a<D.length;++a){if(t.id===D[a]){W=' selected="selected"';break}W=""}'<option value="'+t.id+'"'+W+">"+t.name.replace(/\+/g," ")+"</option>"}),n.find(".redux-typography-style").select2("destroy"),n.find(".redux-typography-style-multi").select2("destroy"),n.find(".redux-typography-style").html(N).select2(),n.find(".redux-typography-style-multi").html(N).select2(),n.find(".redux-typography-subsets").parent().fadeOut("fast"),n.find(".typography-family-backup").fadeOut("fast")):n.find(".redux-typography-style")&&(e.each(F,function(e,t){C===e||"normal"===e?(P=' selected="selected"',n.find(".typography-style select2-selection__rendered").text(t)):P="",N+='<option value="'+e+'"'+P+">"+t.replace("+"," ")+"</option>"}),o&&n.find(".redux-typography-style").select2("destroy"),n.find(".redux-typography-style").html(N).select2());n.find(".redux-typography-font-family").val(y)}else if(e(s).hasClass("redux-typography-family-backup")&&""!==u)n.find(".redux-typography-font-family-backup").val(u);else if(B=F){W="";e.each(B,function(e,t){C===e||"normal"===e?(P=' selected="selected"',n.find(".typography-style select2-selection__rendered").text(t)):P="",N+='<option value="'+e+'"'+P+">"+t.replace("+"," ")+"</option>";for(var a=0;a<D.length;++a){if(t.id===D[a]){W=' selected="selected"';break}W=""}'<option value="'+e+'"'+W+">"+t.replace("+"," ")+"</option>"}),o&&(n.find(".redux-typography-style").select2("destroy"),n.find(".redux-typography-style-multi").select2("destroy")),n.find(".redux-typography-style").html(N).select2(),n.find(".redux-typography-style-multi").html(N).select2(),n.find(".redux-typography-subsets").parent().fadeOut("fast"),n.find(".typography-family-backup").fadeOut("fast")}d&&(n.find(".redux-typography-style").addClass("ignore-change"),0===n.find("select.redux-typography-style option[value='"+C+"']").length?(C="",n.find("select.redux-typography-style").val("").trigger("change")):"400"===C&&n.find("select.redux-typography-style").val(C).trigger("change"),n.find(".redux-typography-style").removeClass("ignore-change"),0===n.find("select.redux-typography-subsets option[value='"+j+"']").length&&(j="",n.find(".redux-typography-style").addClass("ignore-change"),n.find("select.redux-typography-subsets").val("").trigger("change"),n.find("input.typography-subsets").val(j),n.find(".redux-typography-style").removeClass("ignore-change"))),e("."+("style_link_"+l)).remove(),null!==y&&"inherit"!==y&&n.hasClass("typography-initialized")&&(z=y.replace(/\s+/g,"+"),!0===h?(O=z,C&&""!==C&&(O+=":"+C.replace(/\-/g," ")),j&&""!==j&&(O+="&subset="+j),!1===a&&"undefined"!=typeof WebFont&&WebFont&&WebFont.load({google:{families:[O]}}),n.find(".redux-typography-google").val(!0)):n.find(".redux-typography-google").val(!1)),C&&-1!==C.indexOf("italic")?(n.find(".typography-preview").css("font-style","italic"),n.find(".typography-font-style").val("italic"),C=C.replace("italic","")):(n.find(".typography-preview").css("font-style","normal"),n.find(".typography-font-style").val("")),n.find(".typography-font-weight").val(C),""===I||void 0===I?n.find(".typography-font-weight-multi").val(""):n.find(".typography-font-weight-multi").val(I),Boolean(n.find(".redux-typography-height").data("allow-empty"))||f||(f=g),""===g||void 0===g?n.find(".typography-font-size").val(""):n.find(".typography-font-size").val(g+k),""===f||void 0===f?n.find(".typography-line-height").val(""):n.find(".typography-line-height").val(f+k),""===c||void 0===c?n.find(".typography-word-spacing").val(""):n.find(".typography-word-spacing").val(c+k),""===x||void 0===x?n.find(".typography-letter-spacing").val(""):n.find(".typography-letter-spacing").val(x+k),r&&redux.field_objects.pro.typography.select(l),n.hasClass("typography-initialized")&&(0===n.find(".typography-preview").data("preview-size")&&n.find(".typography-preview").css("font-size",g+k),n.find(".typography-preview").css({"font-weight":C,"text-align":v,"font-family":y+", sans-serif"}),"none"===y&&""===y&&n.find(".typography-preview").css("font-family","inherit"),n.find(".typography-preview").css({"line-height":f+k,"word-spacing":c+k,"letter-spacing":x+k}),w&&n.find(".typography-preview").css("color",w),r&&redux.field_objects.typography.previewShadow(l),n.find(".typography-style select2-selection__rendered").text(n.find(".redux-typography-style option:selected").text()),n.find(".typography-multi select2-selection__rendered").text(n.find(".redux-typography-style-multi option:selected").text()),n.find(".typography-script select2-selection__rendered").text(n.find(".redux-typography-subsets option:selected").text()),v&&n.find(".typography-preview").css("text-align",v),m&&n.find(".typography-preview").css("text-transform",m),b&&n.find(".typography-preview").css("font-variant",b),_&&n.find(".typography-preview").css("text-decoration",_),n.find(".typography-preview").slideDown()),n.hasClass("typography-initialized")||n.addClass("typography-initialized"),a=!1,i||redux_change(s)}}(jQuery);